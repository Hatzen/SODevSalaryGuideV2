FROM tomcat:latest
ENV APP_HOME=/usr/app/
WORKDIR $APP_HOME
COPY . .

CMD ["./gradlew", ":application-http-frontend:bootWar"]

# Same as spring config
EXPOSE 8081

ENV SPRING_PROFILES_ACTIVE=prod
# Copy and rename to Root: https://stackoverflow.com/questions/2031537/deploy-war-on-tomcat-without-the-war-name-in-the-url
COPY application-http-frontend/build/libs/application-http-frontend-0.0.1-SNAPSHOT.war /usr/local/tomcat/webapps/ROOT.war
COPY application-http-frontend/src/docker/tomcat-users.xml /usr/local/tomcat/conf/